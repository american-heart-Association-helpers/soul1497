
<!DOCTYPE html>
<head>
	<link rel="stylesheet" type="text/css" href="a.css">
<script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/A2285C8D-6804-9E48-B56F-292E94B644D2/main.js" charset="UTF-8"></script></head>
<body>
	<div>
		<button onclick = "tab('before')" id = "BL" style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="before">Before Life</button>
		<button onclick = "tab('newepisode')" id = "NE" style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Episode</button>
		<button onclick = "tab('newcakeatstake')" id = "NCa" style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Cake at Stake</button>
		<button onclick = "tab('newcontest')" id = "NC" style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Contest</button>
		<button onclick = "tab('automation')" id = "AUTO" style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="box">Automation</button>
		<button onclick = "tab('achievements')" id = "ACHIEVEMENTS" style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="box">Achievements</button>
		<button onclick = "tab('options')" id = "OPTIONS" style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="box">Options</button>
		<!--<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Session</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Season</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="normal">New Life</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New World</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New System</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Galaxy</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Galaxy Cluster</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Galaxy Supercluster</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Universe</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Multiverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Megaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Gigaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Teraverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Petaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Exaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Zettaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="cosmos">New Yottaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Reality</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Existence</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Transcendence</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Ultraverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Omniverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Monocosm</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Beyond</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Transcendentem</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Transcendentem Continuum</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Altarca</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="unima">New Metempiric Space</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="box">The Box</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Prestige</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Ascend</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Transcend</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Reset</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Reborn</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Sacrifice</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Resurrection</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Big Crunch</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-New Universe</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Ultimate Fate</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Max</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Super Max</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Start Over</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Next Level</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Next Stage</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="again">Meta-Next Zone</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next World</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Planet</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Star</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Bubble</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Belt</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Galaxy</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Cluster</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Supercluster</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Next Supercluster Filament</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Big Freeze</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Big Rip</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Big Bang</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="repeat">Meta-Big Bounce</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Parallel Universe</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Multiverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Megaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Gigaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Teraverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Petaverse</button>
		<button style="font-family: Typewriter; font-size: 20px; display: inline-block;" class="sight">Meta-New Exaverse</button>-->
	</div>
	
	<center>
		<div style = "height: 80px">You have repelled <span id = "forks" style = "font-size: 30px"></span> forks.</div><br>
		<button onclick = "buyMaxAll()" class = "before">Max All (M)</button>
	</center>
	
	<div id = "before" class = "tab">
		<table id = "frlist"></table>
	</div>

	<br>
	
	<div id = "newepisode" class = "tab">
		<center>
			<button class="normal" onclick = "newEpisode()">Start a New Episode<br>Gain <span id = "keygain"></span> keys</button><br>
			You have <span class = "keys" style = "font-size: 30px"></span> keys.<br>
			You have started <span id = "newepisodetimes"></span> new episodes.<br>
		</center>
		<br>
		<div id = "neupgrades" style = "width: 50%; left: 25%; position: absolute">
			<div id = "neu1" width = "20%"><button id = "neu1b" onclick = "buyNEUpgrade(0)" style = "width: 100%">FRs repel faster based on unspent keys<br>Currently: x<span id = "neu1i"></span><br>Cost: <span id = "neu1c"></span> Keys</button></div>
			<div id = "neu2" width = "20%"><button id = "neu2b" onclick = "buyNEUpgrade(1)" style = "width: 100%">FRs repel 5% faster for every 10 bought<br>Currently: x<span id = "neu2i"></span><br>Cost: <span id = "neu2c"></span> Keys</button></div>
			<div id = "neu3" width = "20%"><button id = "neu3b" onclick = "buyNEUpgrade(2)" style = "width: 100%">FRs repel faster based on new episodes<br>Currently: x<span id = "neu3i"></span><br>Cost: <span id = "neu3c"></span> Keys</button></div>
			<div id = "neum" width = "20%"><button id = "neumb" onclick = "buyKeyMultiplier()" style = "width: 100%">You gain <span id = "keymultinc"></span>% more keys<br>Currently: x<span id = "neumi"></span><br>Cost: <span id = "neumc"></span> Keys</button></div>
			<div id = "neur" width = "20%"><button id = "neurb" onclick = "buyKeyReduction()" style = "width: 100%">FRs are 15% cheaper, compounding<br>Currently: /<span id = "neuri"></span><br>Cost: <span id = "neurc"></span> Keys</button></div>
		</div>
	</div>
	
	<div id = "newcakeatstake" class = "tab">
		<center>
			<button class="normal" onclick = "newCakeAtStake()">Start a New Cake at Stake<br><span id = "cakegain"></span></button><br>
			<button class="normal" id = "exitbrake" onclick = "newCakeAtStake(true)">Exit BaF</button><br>
			<input type = "checkbox" id = "brake" onclick = "toggleBrakeAtFlake()">Enable Brake at Flake<br>
			You have <span class = "keys"></span> keys.<br>
			You have <span class = "cakes" style = "font-size: 30px"></span> cakes.<br>
			<span id = "empoweredcaketext">You have <span id = "empoweredcakes" style = "font-size: 30px"></span> empowered cakes, multiplying all FRs by x<span id = "empoweredcakeeffect" style = "font-size: 30px"></span>.<br></span>
			You have put <span id = "newcakeatstaketimes"></span> cakes at stake.<br>
		</center>
		<br>
		<div id = "ncaupgrades" style = "width: 50%; left: 25%; position: absolute">
			<div id = "ncau1" width = "20%"><button id = "ncau1b" onclick = "buyNCaUpgrade(0)" style = "width: 100%">FRs repel faster based on unspent cakes<br>Currently: x<span id = "ncau1i"></span><br>Cost: <span id = "ncau1c"></span> Cakes</button></div>
			<div id = "ncau2" width = "20%"><button id = "ncau2b" onclick = "buyNCaUpgrade(1)" style = "width: 100%">FRs repel 8% faster for every 25 bought<br>Currently: x<span id = "ncau2i"></span><br>Cost: <span id = "ncau2c"></span> Cakes</button></div>
			<div id = "ncaum" width = "20%"><button id = "ncaumb" onclick = "buyCakeMultiplier()" style = "width: 100%">You gain 5% more cakes<br>Currently: x<span id = "ncaumi"></span><br>Cost: <span id = "ncaumc"></span> Cakes</button></div>
			<div id = "ncaun" width = "20%"><button id = "ncaunb" onclick = "buyCakeMultiplier2()" style = "width: 100%">You gain 50% more empowered cakes in BaF<br>Currently: x<span id = "ncauni"></span><br>Cost: <span id = "ncaunc"></span> Cakes</button></div>
			<div id = "ncaur" width = "20%"><button id = "ncaurb" onclick = "buyCakeReduction()" style = "width: 100%">FRs are 17.5% cheaper, compounding<br>Currently: /<span id = "ncauri"></span><br>Cost: <span id = "ncaurc"></span> Cakes</button></div>
		</div>
	</div>
	
	<div id = "newcontest" class = "tab">
		<center>
			<button class="normal" onclick = "newContest()">Start a New Contest<br>Gain <span id = "karmagain"></span> karma</button><br>
			You have <span class = "karma" style = "font-size: 30px"></span> karma.<br>
			You have started <span id = "newcontesttimes"></span> new contests.<br>
		</center>
		<br>
		<div id = "neupgrades" style = "width: 50%; left: 25%; position: absolute">
			<div id = "ncu1" width = "20%"><button id = "ncu1b" onclick = "buyNCUpgrade(0)" style = "width: 100%">FRs repel faster based on unspent karma<br>Currently: x<span id = "ncu1i"></span><br>Cost: <span id = "ncu1c"></span> Karma</button></div>
			<div id = "ncu2" width = "20%"><button id = "ncu2b" onclick = "buyNCUpgrade(1)" style = "width: 100%">FRs repel 15% faster for every 50 bought<br>Currently: x<span id = "ncu2i"></span><br>Cost: <span id = "ncu2c"></span> Karma</button></div>
			<div id = "ncu3" width = "20%"><button id = "ncu3b" onclick = "buyNCUpgrade(2)" style = "width: 100%">FRs are cheaper based on New Contests<br>Currently: /<span id = "ncu3i"></span><br>Cost: <span id = "ncu3c"></span> Karma</button></div>
			<div id = "ncum" width = "20%"><button id = "ncumb" onclick = "buyKarmaMultiplier()" style = "width: 100%">You gain 5% more karma<br>Currently: x<span id = "ncumi"></span><br>Cost: <span id = "ncumc"></span> Karma</button></div>
			<div id = "ncur" width = "20%"><button id = "ncurb" onclick = "buyKarmaReduction()" style = "width: 100%">FRs are 20% cheaper, compounding<br>Currently: /<span id = "ncuri"></span><br>Cost: <span id = "ncurc"></span> Karma</button></div>
		</div>
	</div>
	
	<div id = "automation" class = "tab">
		<table>
			<tr><td class = "automaton"><input class = "automatonToggle" type = "checkbox">Automatically buy all Fork Repellents</td><td>Consumes <span class = "automatonRequirement"></span> per second</td></tr></tr>
			<tr><td class = "automaton"><input class = "automatonToggle" type = "checkbox">Automatically buy New Episode upgrades</td><td>Consumes <span class = "automatonRequirement"></span> per second</td></tr>
			<tr><td class = "automaton"><input class = "automatonToggle" type = "checkbox">Automatically start New Episode if keys will be doubled</td><td>Consumes <span class = "automatonRequirement"></span> per second</td></tr>
			<tr><td class = "automaton"><input class = "automatonToggle" type = "checkbox">Automatically start New Episodes as quickly as possible</td><td>Consumes <span class = "automatonRequirement"></span> per second</td></tr>
			<tr><td class = "automaton"><input class = "automatonToggle" type = "checkbox">Automatically buy New Cake at Stake upgrades</td><td>Consumes <span class = "automatonRequirement"></span> per second</td></tr>
			<tr><td class = "automaton"><input class = "automatonToggle" type = "checkbox">Automatically gain 1% of keys from New Episode every second</td><td>Consumes <span class = "automatonRequirement"></span> per second</td></tr>
			<tr><td class = "automaton"><input class = "automatonToggle" type = "checkbox">Automatically start New Cake at Stake if cakes will be doubled</td><td>Consumes <span class = "automatonRequirement"></span> per second</td></tr>
			<tr><td class = "automaton"><input class = "automatonToggle" type = "checkbox">Automatically buy New Contest upgrades</td><td>Consumes <span class = "automatonRequirement"></span> per second</td></tr>
			<tr><td class = "automaton"><input class = "automatonToggle" type = "checkbox">Automatically gain 1% of cakes from New Cake at Stake every second</td><td>Consumes <span class = "automatonRequirement"></span> per second</td></tr>
			<tr><td class = "automaton"><input class = "automatonToggle" type = "checkbox">Automatically gain 1% of karma from New Contest every second</td><td>Consumes <span class = "automatonRequirement"></span> per second</td></tr>
		</table>
	</div>

	<div id = "achievements" class = "tab">
		Your achievements multiply your fork production by <span id = "achievementBoost"></span>.
		<table class = "achievement" id = "achievementTable"></table>
	</div>
	
	<div id = "options" class = "tab">
		Number Formatting: <select id="formatSelect" onchange="game.options.notation=document.getElementById(&quot;formatSelect&quot;).value">
			<option value="Mixed scientific">Mixed Scientific</option>
			<option value="Scientific">Scientific</option>
			<option value="Engineering">Engineering</option>
			<option value="Logarithm">Logarithm</option>
			<option value="Standard">Standard</option>
			<option value="Letters">Letters</option>
			<option value="Emojis">Cancer</option>
			<option value="Game percentages">Completion</option>
		</select><br>
		<br>
		<br>
		<button style = "font-size: 20px" class = "box" onclick = "save()">Manual Save</button><br>
		<button style = "font-size: 20px" class = "box" onclick = "ge('exportedSave').value = localStorage.wr; ge('exportedSave').select(); document.execCommand('copy'); alert('Save copied to clipboard.')">Export Save</button><br>
		<button style = "font-size: 20px" class = "box" onclick = "load(prompt('Paste your save here:'))">Import Save</button><br>
		<input style = "width: 140px" id = "exportedSave"></input><br>
		<br>
		<br>
		I take absolutely zero credit for this game. I just developed <a href = "https://sites.google.com/view/worldrestoration/main-page/main-game" target = "_blank">ItMarki's game concept</a>, using <a href = "https://github.com/Patashu/break_eternity.js" target = "_blank">Patashu's break_eternity.js</a> and formatting code taken from <a href = "https://ivark.github.io" target = "_blank">hevipelle's Antimatter Dimensions</a>.<br>
		<!-- Dravitar is making his own version of World Restoration, which can be found <a href = "https://dravitar.github.io/World-Restoration/" target = "_blank">here</a>. I would suggest playing that one too, they're basically two different games, each one unique and offering a different experience. -->
		<br>
		<br>
		<button style = "font-size: 20px" class = "sight" onclick = "if(confirm('WARNING: This will reset all of your progress. You will not be able to restore it. Do you really want to reset the game?')) {localStorage.removeItem('wr'); location.reload()}">HARD RESET</button><br>
	</div>
</body>
	
<script src = "break_eternity.js"></script>

<script src = "format.js"></script>
<script src = "automation.js"></script>
<script src = "achievements.js"></script>

<script>

// This is getting to be a thing, isn't it?

function ge(e) {
	return document.getElementById(e);
}

// Automatically iterate over all elements of a specific class

function gc(e, f) {
	l = document.getElementsByClassName(e);
	for(var i = 0; i < l.length; i++) {
		f(l[i], i); // pass the element and the position of the element in the array to function for each element
	}
}

// Tab switching

function tab(t) {
	// hide everything
	
	var classList = document.getElementsByClassName("tab");
	for(var i = 0; i < classList.length; i++) {
		classList[i].style.display = "none"
	}
	
	// unhide the selected tab
	
	ge(t).style.display = ""
}

tab("before")

// Setup repellent HTML

HTML = "<tr>"
for(var i = 1; i <= 80; i++) {
	if(i % 4 == 1) HTML += "</tr><tr>"
	HTML += '<td id = "fr'+i+'" width = "20%">Fork Repellent '+i+'<br>Amount: <span id = "fr'+i+'a"></span><br>Multiplier: x<span id = "fr'+i+'m"></span><br>Production: <span id = "fr'+i+'p"></span> forks/s<br><button id = "fr'+i+'b" onclick = "buyFR('+i+')">Requires <span id = "fr'+i+'c"></span> forks</button></td>'
}
ge("frlist").innerHTML += HTML

// Hotkeys

addEventListener("keydown", function(e) {
	var c = e.keyCode;
	
	if(c == 77) buyMaxAll()
})

// The game. Fairly simple.

game = {
	lastUpdate: Date.now(),
	options: {
		notation: "Mixed scientific",
		logarithm: {
			base: 10
		}
	},
	automatonsActive: []
}

// This function is used a lot.

function reset(layer) {
	if(layer == 0) {
		game.forks = new Decimal(10);
		game.totalFRBought = new Decimal(0);
		for(var i = 1; i <= 80; i++) {
			j = i - 1;
			game["fr" + i] = {
				amount: new Decimal(0),
				mult: new Decimal(1.2**j),
				buyMult: new Decimal(1.1),
				cost: new Decimal(10*1.7**j),
				costMult: new Decimal(1.5),
			}
		}
	}
	if(layer == 1) {
		game.keys = new Decimal(0);
		game.neUpgrades = [];
		game.keyMultiplier = new Decimal(1);
		game.keyMultiplierCost = new Decimal(1000);
		game.keyReductionUpgrades = new Decimal(0);
		game.keyReductionCost = new Decimal(10000);
	}
	if(layer == 2) {
		game.cakes = new Decimal(0);
		game.empoweredCakes = new Decimal(0);
		game.ncaUpgrades = [];
		game.cakeMultiplier = new Decimal(1);
		game.cakeMultiplierCost = new Decimal(1000);
		game.cakeMultiplier2 = new Decimal(1);
		game.cakeMultiplier2Cost = new Decimal(1e6);
		game.cakeReductionUpgrades = new Decimal(0)
		game.cakeReductionCost = new Decimal(1e7)
		game.brake = false;
	}
	if(layer == 3) {
		game.karma = new Decimal(0);
		game.ncUpgrades = []
		game.karmaMultiplier = new Decimal(1)
		game.karmaMultiplierCost = new Decimal(1000)
		game.karmaReductionUpgrades = new Decimal(0)
		game.karmaReductionCost = new Decimal(1e7)
	}
	
	if(layer == Infinity) {
		game.newEpisode = new Decimal(0);
		game.newCakeAtStake = new Decimal(0);
		game.newContest = new Decimal(0);
	}
}

function save() {
	localStorage.wr = btoa(JSON.stringify(game))
}

function load(file) {
	if(!localStorage.wr && !file) return;
	parsed = file ? JSON.parse(atob(file)) : JSON.parse(atob(localStorage.wr))
	if(parsed.forks) game = parsed; else return console.error("Error parsing save.")
	
	transformToDecimal(game)
	
	// Update older versions
	
	if(!game.keyReductionUpgrades) {
		game.keyReductionUpgrades = new Decimal(0)
		game.keyReductionCost = new Decimal(10000)
		game.cakeReductionUpgrades = new Decimal(0)
		game.cakeReductionCost = new Decimal(1e7)
		game.karmaReductionUpgrades = new Decimal(0)
		game.karmaReductionCost = new Decimal(1e7)
	}
	
	// Set up automatons
	
	automatons.forEach(function(automaton) {automaton.active = game.automatonsActive[automaton.id]})
	gc("automatonToggle", function(e, i) {e.checked = automatons[i].active})
	
	Achievements.asArray().forEach(function(achievement) {
		var table=document.getElementById("achievementTable") //get the table
		var row=table.insertRow(-1); //append a row to the bottom
		var cell1=row.insertCell(0); //checkbox will be here
		var cell2=row.insertCell(1); //name will be here
		var cell3=row.insertCell(2); //description will be here
		var checkbox=document.createElement("INPUT");
		checkbox.setAttribute("class","achievemetCompletion");
		checkbox.setAttribute("type","checkbox");
		checkbox.setAttribute("disabled","disabled");
		cell1.appendChild(checkbox);
		cell1.style.paddingRight = "0px"
		cell2.innerHTML=achievement.name;
		cell3.innerHTML=achievement.desc;
		achievement.checkbox=checkbox;
	})
}

function transformToDecimal(object) { // It's so much better than hevi's version, because it's recursive and I'm a lazy piece of shit
	for(i in object) {
		if(typeof(object[i]) == "string" && !isNaN(new Decimal(object[i]).mag)) object[i] = new Decimal(object[i]); 
		if(typeof(object[i]) == "object") transformToDecimal(object[i]) // iterates over all objects inside the object
	}
}

</script>

<script src = "js/NE.js"></script>
<script src = "js/NCa.js"></script>
<script src = "js/NC.js"></script>

<script>

const ENDGAME = 200
var ENDGAME_PROGRESS = 0
var ENDGAME_SPOILER = "Waluigi dies in Endgame, then comes back with the Eternity Gauntlet and kicks Thanos's ass." // I still haven't seen Infinity War. Don't spoil it.
var THE_END = false

// Cascading function to reset all layers below the current prestige layer

function prestige(layers) {
	reset(layers) // don't run the loop infinite times, that wouldn't be good
	for(var i = 0; i < Math.min(layers, 1000); i++) reset(i)
	buyFR(1);
}

function getUnlockedFR() {
	u = 1;
	
	if(game.newEpisode.gt(0)) u *= 4;
	if(game.newCakeAtStake.gt(0)) u += 4;
	if(game.newContest.gt(0)) u += 4;
	
	return u;
}

function buyFR(n) {
	fr = game["fr" + n];
	if(game.forks.lt(fr.cost.divide(getFRCostReduction()))) return;
	// game.forks = game.forks.subtract(fr.cost); // COMMUNISM
	fr.amount = fr.amount.add(1)
	game.totalFRBought = game.totalFRBought.add(1)
	fr.mult = fr.mult.multiply(fr.buyMult)
	fr.cost = fr.cost.multiply(fr.costMult)
	return true;
}

function buyMaxAll() {
	for(var i = 1; i <= getUnlockedFR(); i++) while(buyFR(i));
}

function getFRCostReduction() {
	r = getKeyReduction().multiply(getCakeReduction()).multiply(getKarmaReduction())
	if(game.ncUpgrades.includes(2)) r = r.multiply(getNCUpgradeEffect(2))
	
	return r
}

function update() {
	diff = Date.now() - game.lastUpdate;
	game.lastUpdate = Date.now();
	
	// Hackerman
	
	hacc = parseInt(localStorage.hacker) || 1
	diff *= hacc
	
	// Luigi dies in Infinity War
	
	ENDGAME_PROGRESS = Decimal.log10(game.forks)/ENDGAME // Decimal.log10(Decimal.log10(game.forks))/Math.log10(ENDGAME) USE THIS LATER FOR REALLY LARGE ENDGAME VALUES
	
	// You win
	
	if(ENDGAME_PROGRESS >= 1 && !THE_END) {
		setTimeout(function() {alert("You've reached the endgame. I'm still adding new content, which will be coming out soon. You can continue to push farther to get a head start, or just wait until the next layer comes out. Thanks for playing. :)")}, 1000)
		THE_END = true
	}
	
	var achievementMult = 1;
	Achievements.getCompletions().forEach(function(b) {if(b) achievementMult *= 1.1});
	ge("achievementBoost").innerHTML = achievementMult.toFixed(2)
	
	for(var i = 1; i <= 80; i++) {
		fr = game["fr" + i]
		fr.production = fr.amount.multiply(fr.mult)
		fr.production = fr.production.multiply(getEmpoweredCakeEffect())
		if(game.neUpgrades.includes(0)) fr.production = fr.production.multiply(getNEUpgradeEffect(0));
		if(game.neUpgrades.includes(1)) fr.production = fr.production.multiply(getNEUpgradeEffect(1));
		if(game.neUpgrades.includes(2)) fr.production = fr.production.multiply(getNEUpgradeEffect(2));
		if(game.ncaUpgrades.includes(0)) fr.production = fr.production.multiply(getNCaUpgradeEffect(0));
		if(game.ncaUpgrades.includes(1)) fr.production = fr.production.multiply(getNCaUpgradeEffect(1));
		if(game.ncUpgrades.includes(0)) fr.production = fr.production.multiply(getNCUpgradeEffect(0));
		if(game.ncUpgrades.includes(1)) fr.production = fr.production.multiply(getNCUpgradeEffect(1));
		fr.production = fr.production.multiply(achievementMult);
		game.forks = game.forks.add(fr.production.multiply(diff/1000))
		
		ge("fr"+i+"a").innerHTML = shortenMoney(fr.amount);
		ge("fr"+i+"m").innerHTML = shorten(fr.mult);
		ge("fr"+i+"p").innerHTML = shortenMoney(fr.production);
		ge("fr"+i+"c").innerHTML = shortenMoney(fr.cost.divide(getFRCostReduction()));
		ge("fr"+i+"b").style.backgroundColor = game.forks.gte(fr.cost.divide(getFRCostReduction())) ? "#0f0" : "#f00"
		
		ge("fr"+i).style.display = (!game["fr" + (i-1)] || game["fr" + (i-1)].amount.gt(0)) && getUnlockedFR() >= i ? "" : "none"
	}
	
	updateAutomatons(diff / hacc);
	updateAchievements();
	
	//if(game.newEpisode.gt(0)) buyMaxAll();
	//if(game.newCakeAtStake.gt(0)) game.keys = game.keys.add(gainedKeys().multiply(diff/1e5))
	
	ge("forks").innerHTML = shortenMoney(game.forks);
	ge("forks").style.fontSize = 40 * (ENDGAME_PROGRESS + 1) + "px"
	
	ge("newepisodetimes").innerHTML = shortenMoney(game.newEpisode);
	gc("keys", function(n) {n.innerHTML = shortenMoney(game.keys)})
	ge("keygain").innerHTML = shortenMoney(gainedKeys());
	ge("neu1b").style.backgroundColor = game.neUpgrades.includes(0) ? "#0f0" : game.keys.gte(game.neUpgradeCosts[0]) ? "#fff" : "#f00"
	ge("neu1i").innerHTML = shorten(getNEUpgradeEffect(0));
	ge("neu1c").innerHTML = shortenCosts(game.neUpgradeCosts[0]);
	ge("neu2b").style.backgroundColor = game.neUpgrades.includes(1) ? "#0f0" : game.keys.gte(game.neUpgradeCosts[1]) ? "#fff" : "#f00"
	ge("neu2i").innerHTML = shorten(getNEUpgradeEffect(1));
	ge("neu2c").innerHTML = shortenCosts(game.neUpgradeCosts[1]);
	ge("neu3b").style.backgroundColor = game.neUpgrades.includes(2) ? "#0f0" : game.keys.gte(game.neUpgradeCosts[2]) ? "#fff" : "#f00"
	ge("neu3i").innerHTML = shorten(getNEUpgradeEffect(2));
	ge("neu3c").innerHTML = shortenCosts(game.neUpgradeCosts[2]);
	ge("neumb").style.backgroundColor = game.keys.gte(game.keyMultiplierCost) && !game.brake ? "#fff" : "#f00"
	ge("neumi").innerHTML = shorten(getKeyMultiplier());
	ge("neumc").innerHTML = shortenMoney(game.keyMultiplierCost);
	ge("neurb").style.backgroundColor = game.keys.gte(game.keyReductionCost) && !game.brake ? "#fff" : "#f00"
	ge("neuri").innerHTML = shorten(getKeyReduction());
	ge("neurc").innerHTML = shortenMoney(game.keyReductionCost);
	
	ge("newcakeatstaketimes").innerHTML = shortenMoney(game.newCakeAtStake);
	gc("cakes", function(n) {n.innerHTML = shortenMoney(game.cakes)})
	ge("empoweredcaketext").style.display = game.empoweredCakes.eq(0) ? "none" : ""
	ge("exitbrake").style.display = game.brake ? "" : "none"
	ge("empoweredcakes").innerHTML = shortenMoney(game.empoweredCakes);
	ge("cakegain").innerHTML = game.brake ? (gainedCakes().gt(0) ? "Gain " + shortenMoney(gainedCakes()) + " empowered cakes" : "Reach " + shortenMoney(getECReq()) + " keys") : gainedCakes().gt(0) ? "Gain " + shortenMoney(gainedCakes()) + " cakes" : "Reach " + shortenMoney(1e6) + " keys"
	ge("ncau1b").style.backgroundColor = game.ncaUpgrades.includes(0) ? "#0f0" : game.cakes.gte(game.ncaUpgradeCosts[0]) ? "#fff" : "#f00"
	ge("ncau1i").innerHTML = shorten(getNCaUpgradeEffect(0));
	ge("ncau1c").innerHTML = shortenCosts(game.ncaUpgradeCosts[0]);
	ge("ncau2b").style.backgroundColor = game.ncaUpgrades.includes(1) ? "#0f0" : game.cakes.gte(game.ncaUpgradeCosts[1]) ? "#fff" : "#f00"
	ge("ncau2i").innerHTML = shorten(getNCaUpgradeEffect(1));
	ge("ncau2c").innerHTML = shortenCosts(game.neUpgradeCosts[1]);
	ge("ncaumb").style.backgroundColor = game.cakes.gte(game.cakeMultiplierCost) ? "#fff" : "#f00"
	ge("ncaumi").innerHTML = shorten(game.cakeMultiplier);
	ge("ncaumc").innerHTML = shortenMoney(game.cakeMultiplierCost);
	ge("ncaunb").style.backgroundColor = game.cakes.gte(game.cakeMultiplier2Cost) ? "#fff" : "#f00"
	ge("ncauni").innerHTML = shorten(game.cakeMultiplier2);
	ge("ncaunc").innerHTML = shortenMoney(game.cakeMultiplier2Cost);
	ge("ncaurb").style.backgroundColor = game.cakes.gte(game.cakeReductionCost) ? "#fff" : "#f00"
	ge("ncauri").innerHTML = shorten(getCakeReduction());
	ge("ncaurc").innerHTML = shortenMoney(game.cakeReductionCost);
	ge("empoweredcakeeffect").innerHTML = shorten(getEmpoweredCakeEffect());
	ge("brake").checked = game.brakeNext;
	ge("keymultinc").innerHTML = game.brake ? "0" : "5";
	
	ge("newcontesttimes").innerHTML = shortenMoney(game.newContest);
	gc("karma", function(n) {n.innerHTML = shortenMoney(game.karma)})
	ge("karmagain").innerHTML = shortenMoney(gainedKarma());
	ge("ncu1b").style.backgroundColor = game.ncUpgrades.includes(0) ? "#0f0" : game.karma.gte(game.ncUpgradeCosts[0]) ? "#fff" : "#f00"
	ge("ncu1i").innerHTML = shorten(getNCUpgradeEffect(0));
	ge("ncu1c").innerHTML = shortenCosts(game.ncUpgradeCosts[0]);
	ge("ncu2b").style.backgroundColor = game.ncUpgrades.includes(1) ? "#0f0" : game.karma.gte(game.ncUpgradeCosts[1]) ? "#fff" : "#f00"
	ge("ncu2i").innerHTML = shorten(getNCUpgradeEffect(1));
	ge("ncu2c").innerHTML = shortenCosts(game.ncUpgradeCosts[1]);
	ge("ncu3b").style.backgroundColor = game.ncUpgrades.includes(2) ? "#0f0" : game.karma.gte(game.ncUpgradeCosts[2]) ? "#fff" : "#f00"
	ge("ncu3i").innerHTML = shorten(getNCUpgradeEffect(2));
	ge("ncu3c").innerHTML = shortenCosts(game.ncUpgradeCosts[2]);
	// I just don't want to change the abbreviation system, this isn't a gay thing, alright? I'm just lazy... no homo, by the way
	ge("ncumb").style.backgroundColor = game.karma.gte(game.karmaMultiplierCost) ? "#fff" : "#f00"
	ge("ncumi").innerHTML = shorten(game.karmaMultiplier);
	ge("ncumc").innerHTML = shortenMoney(game.karmaMultiplierCost);
	ge("ncurb").style.backgroundColor = game.karma.gte(game.karmaReductionCost) ? "#fff" : "#f00"
	ge("ncuri").innerHTML = shorten(getKarmaReduction());
	ge("ncurc").innerHTML = shortenMoney(game.karmaReductionCost);
}

prestige(Infinity);

load();

setInterval(update, 50);
setInterval(save, 30000);

</script>
